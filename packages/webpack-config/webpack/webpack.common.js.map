{"version":3,"file":"webpack.common.js","sourceRoot":"","sources":["../src/webpack.common.ts"],"names":[],"mappings":"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","sourcesContent":["import { createEnvironmentConstants } from '@expo/config';\nimport WebpackPWAManifestPlugin from '@expo/webpack-pwa-manifest-plugin';\nimport chalk from 'chalk';\nimport path from 'path';\nimport HtmlWebpackPlugin from 'html-webpack-plugin';\nimport ProgressBarPlugin from 'progress-bar-webpack-plugin';\nimport InterpolateHtmlPlugin from 'react-dev-utils/InterpolateHtmlPlugin';\nimport webpack, { DefinePlugin, HotModuleReplacementPlugin } from 'webpack';\nimport { BundleAnalyzerPlugin } from 'webpack-bundle-analyzer';\nimport WebpackDeepScopeAnalysisPlugin from 'webpack-deep-scope-plugin';\nimport WorkboxPlugin from 'workbox-webpack-plugin';\nimport CleanWebpackPlugin from 'clean-webpack-plugin';\nimport ModuleNotFoundPlugin from 'react-dev-utils/ModuleNotFoundPlugin';\nimport PnpWebpackPlugin from 'pnp-webpack-plugin';\nimport ModuleScopePlugin from 'react-dev-utils/ModuleScopePlugin';\nimport ManifestPlugin from 'webpack-manifest-plugin';\nimport CaseSensitivePathsPlugin from 'case-sensitive-paths-webpack-plugin';\nimport WatchMissingNodeModulesPlugin from 'react-dev-utils/WatchMissingNodeModulesPlugin';\nimport MiniCssExtractPlugin from 'mini-css-extract-plugin';\nimport CompressionPlugin from 'compression-webpack-plugin';\nimport BrotliPlugin from 'brotli-webpack-plugin';\nimport CopyWebpackPlugin from 'copy-webpack-plugin';\nimport WebpackNotifierPlugin from 'webpack-notifier';\nimport SpeedMeasurePlugin from 'speed-measure-webpack-plugin';\nimport createIndexHTMLFromAppJSONAsync from './createIndexHTMLFromAppJSONAsync';\nimport createClientEnvironment from './createClientEnvironment';\nimport getPathsAsync from './utils/getPathsAsync';\nimport { enableWithPropertyOrConfig, overrideWithPropertyOrConfig } from './utils/config';\nimport createFontLoader from './loaders/createFontLoader';\nimport createBabelLoaderAsync from './loaders/createBabelLoaderAsync';\nimport getMode from './utils/getMode';\nimport getConfigAsync from './utils/getConfigAsync';\nimport { Environment, Arguments } from './types';\n\nconst DEFAULT_ALIAS = {\n  // Alias direct react-native imports to react-native-web\n  'react-native$': 'react-native-web',\n  '@react-native-community/netinfo': 'react-native-web/dist/exports/NetInfo',\n  // Add polyfills for modules that react-native-web doesn't support\n  // Depends on expo-asset\n  'react-native/Libraries/Image/AssetSourceResolver$': 'expo-asset/build/AssetSourceResolver',\n  'react-native/Libraries/Image/assetPathUtils$': 'expo-asset/build/Image/assetPathUtils',\n  'react-native/Libraries/Image/resolveAssetSource$': 'expo-asset/build/resolveAssetSource',\n  // Alias internal react-native modules to react-native-web\n  'react-native/Libraries/Components/View/ViewStylePropTypes$':\n    'react-native-web/dist/exports/View/ViewStylePropTypes',\n  'react-native/Libraries/EventEmitter/RCTDeviceEventEmitter$':\n    'react-native-web/dist/vendor/react-native/NativeEventEmitter/RCTDeviceEventEmitter',\n  'react-native/Libraries/vendor/emitter/EventEmitter$':\n    'react-native-web/dist/vendor/react-native/emitter/EventEmitter',\n  'react-native/Libraries/vendor/emitter/EventSubscriptionVendor$':\n    'react-native-web/dist/vendor/react-native/emitter/EventSubscriptionVendor',\n  'react-native/Libraries/EventEmitter/NativeEventEmitter$':\n    'react-native-web/dist/vendor/react-native/NativeEventEmitter',\n};\n\nconst DEFAULT_GZIP = {\n  test: /\\.(js|css)$/,\n  filename: '[path].gz[query]',\n  algorithm: 'gzip',\n  threshold: 1024,\n  minRatio: 0.8,\n};\n\nconst DEFAULT_BROTLI = {\n  asset: '[path].br[query]',\n  test: /\\.(js|css)$/,\n  threshold: 1024,\n  minRatio: 0.8,\n};\n\nconst DEFAULT_SERVICE_WORKER = {};\n\nconst DEFAULT_REPORT_CONFIG = {\n  verbose: true,\n  path: 'web-report',\n  statsFilename: 'stats.json',\n  reportFilename: 'report.html',\n};\n\n// This is needed for webpack to import static images in JavaScript files.\n// \"url\" loader works like \"file\" loader except that it embeds assets\n// smaller than specified limit in bytes as data URLs to avoid requests.\n// A missing `test` is equivalent to a match.\n// TODO: Bacon: Move SVG\nconst imageLoaderConfiguration = {\n  test: /\\.(gif|jpe?g|png|svg)$/,\n  use: {\n    loader: 'url-loader',\n    options: {\n      // Inline resources as Base64 when there is less reason to parallelize their download. The\n      // heuristic we use is whether the resource would fit within a TCP/IP packet that we would\n      // send to request the resource.\n      //\n      // An Ethernet MTU is usually 1500. IP headers are 20 (v4) or 40 (v6) bytes and TCP\n      // headers are 40 bytes. HTTP response headers vary and are around 400 bytes. This leaves\n      // about 1000 bytes for content to fit in a packet.\n      limit: 1000,\n      name: 'static/media/[name].[hash:8].[ext]',\n    },\n  },\n};\n\nconst styleLoaderConfiguration = {\n  test: /\\.(css)$/,\n  use: ['style-loader', 'css-loader'],\n};\n\n// \"file\" loader makes sure those assets get served by WebpackDevServer.\n// When you `import` an asset, you get its (virtual) filename.\n// In production, they would get copied to the `build` folder.\n// This loader doesn't use a \"test\" so it will catch all modules\n// that fall through the other loaders.\nconst fallbackLoaderConfiguration = {\n  loader: require.resolve('file-loader'),\n  // Exclude `js` files to keep \"css\" loader working as it injects\n  // its runtime that would otherwise be processed through \"file\" loader.\n  // Also exclude `html` and `json` extensions so they get processed\n  // by webpacks internal loaders.\n\n  // Excludes: js, jsx, ts, tsx, html, json\n  exclude: [/\\.jsx?$/, /\\.tsx?$/, /\\.html$/, /\\.json$/],\n  options: {\n    name: 'static/media/[name].[hash:8].[ext]',\n  },\n};\n\nfunction createNoJSComponent(message: string): string {\n  // from twitter.com\n  return `\" <form action=\"location.reload()\" method=\"POST\" style=\"background-color:#fff;position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999;\"><div style=\"font-size:18px;font-family:Helvetica,sans-serif;line-height:24px;margin:10%;width:80%;\"> <p>${message}</p> <p style=\"margin:20px 0;\"> <button type=\"submit\" style=\"background-color: #4630EB; border-radius: 100px; border: none; box-shadow: none; color: #fff; cursor: pointer; font-size: 14px; font-weight: bold; line-height: 20px; padding: 6px 16px;\">Reload</button> </p> </div> </form> \"`;\n}\n\nfunction getDevtool(env: Environment, devtool?: webpack.Options.Devtool): webpack.Options.Devtool {\n  if (env.production) {\n    // string or false\n    if (devtool !== undefined) {\n      // When big assets are involved sources maps can become expensive and cause your process to run out of memory.\n      return devtool;\n    }\n    return 'source-map';\n  }\n  if (env.development) {\n    return 'cheap-module-source-map';\n  }\n  return false;\n}\n\nexport default async function(env = {}, argv: Arguments): Promise<webpack.Configuration> {\n  const config = await getConfigAsync(env);\n  const mode = getMode(env);\n  const isDev = mode === 'development';\n  const isProd = mode === 'production';\n  let pluginNames = {};\n  // Enables deep scope analysis in production mode.\n  // Remove unused import/exports\n  // override: `env.deepScopeAnalysis`\n  const deepScopeAnalysisEnabled = overrideWithPropertyOrConfig(\n    env.removeUnusedImportExports,\n    isProd\n  );\n\n  const locations = await getPathsAsync(env);\n  const publicAppManifest = createEnvironmentConstants(config, locations.production.manifest);\n\n  // const middlewarePlugins = [];\n\n  const { build: buildConfig } = config.web;\n  const { lang } = config.web;\n  const { publicPath, rootId, babel: babelAppConfig = {} } = config.web.build;\n  const { noJavaScriptMessage } = config.web.dangerous;\n  const noJSComponent = createNoJSComponent(noJavaScriptMessage);\n\n  /**\n   * report: {\n   *   verbose: false,\n   *   path: \"web-report\",\n   *   statsFilename: \"stats.json\",\n   *   reportFilename: \"report.html\"\n   * }\n   */\n  let reportPlugins = [];\n\n  const devtool = getDevtool(env, config.web.build.devtool);\n\n  const allLoaders = [\n    {\n      test: /\\.html$/,\n      use: ['html-loader'],\n      exclude: locations.template.folder,\n    },\n    imageLoaderConfiguration,\n    await createBabelLoaderAsync({\n      mode,\n      babelProjectRoot: babelAppConfig.root || locations.root,\n      verbose: babelAppConfig.verbose,\n      include: babelAppConfig.include,\n      use: babelAppConfig.use,\n    }),\n    createFontLoader({ locations }),\n\n    styleLoaderConfiguration,\n    // This needs to be the last loader\n    fallbackLoaderConfiguration,\n  ].filter(Boolean);\n\n  /**\n   * web: {\n   *   build: {\n   *     verbose: boolean,\n   *     brotli: boolean | {}, // (Brotli Options)\n   *     gzip: boolean | CompressionPlugin.Options<O>,\n   *   }\n   * }\n   */\n  const gzipConfig = isProd && overrideWithPropertyOrConfig(buildConfig.gzip, DEFAULT_GZIP);\n  const brotliConfig = isProd && enableWithPropertyOrConfig(buildConfig.brotli, DEFAULT_BROTLI);\n\n  const appEntry = [locations.appMain];\n\n  if (isProd) {\n    if (env.polyfill) {\n      appEntry.unshift('@babel/polyfill');\n    }\n  } else {\n    // https://github.com/facebook/create-react-app/blob/e59e0920f3bef0c2ac47bbf6b4ff3092c8ff08fb/packages/react-scripts/config/webpack.config.js#L144\n    // Include an alternative client for WebpackDevServer. A client's job is to\n    // connect to WebpackDevServer by a socket and get notified about changes.\n    // When you save a file, the client will either apply hot updates (in case\n    // of CSS changes), or refresh the page (in case of JS changes). When you\n    // make a syntax error, this client will display a syntax error overlay.\n    // Note: instead of the default WebpackDevServer client, we use a custom one\n    // to bring better experience for Create React App users. You can replace\n    // the line below with these two lines if you prefer the stock client:\n    // require.resolve('webpack-dev-server/client') + '?/',\n    // require.resolve('webpack/hot/dev-server'),\n    appEntry.unshift(require.resolve('react-dev-utils/webpackHotDevClient'));\n  }\n\n  const environmentVariables = createClientEnvironment(mode, publicPath, publicAppManifest);\n\n  if (isProd) {\n    // Delete the build folder\n\n    pluginNames['Delete existing build folder'] = new CleanWebpackPlugin(\n      [locations.production.folder],\n      {\n        root: locations.root,\n        dry: false,\n        verbose: buildConfig.verbose,\n      }\n    );\n    // Copy the template files over\n\n    pluginNames['Create a new build folder and copy template files'] = new CopyWebpackPlugin([\n      {\n        from: locations.template.folder,\n        to: locations.production.folder,\n        // We generate new versions of these based on the templates\n        ignore: ['favicon.ico', 'serve.json', 'index.html', 'icon.png'],\n      },\n      {\n        from: locations.template.serveJson,\n        to: locations.production.serveJson,\n      },\n      {\n        from: locations.template.favicon,\n        to: locations.production.favicon,\n      },\n    ]);\n  }\n\n  // Generate the `index.html`\n  pluginNames['Generating the index.html'] = await createIndexHTMLFromAppJSONAsync(env);\n\n  // Add variables to the `index.html`\n  const interpolateHtmlPlugin = new InterpolateHtmlPlugin(HtmlWebpackPlugin, {\n    PUBLIC_URL: publicPath,\n    WEB_TITLE: config.web.name,\n    NO_SCRIPT: noJSComponent,\n    LANG_ISO_CODE: lang,\n    ROOT_ID: rootId,\n  });\n  pluginNames['Interpolate HTML'] = interpolateHtmlPlugin;\n\n  pluginNames['Create the PWA'] = new WebpackPWAManifestPlugin(config, {\n    publicPath,\n    noResources: isDev || !env.pwa,\n    filename: locations.production.manifest,\n    HtmlWebpackPlugin,\n  });\n\n  // This gives some necessary context to module not found errors, such as\n  // the requesting resource.\n  pluginNames['Adding resource errors'] = new ModuleNotFoundPlugin(locations.root);\n\n  pluginNames['Creating environment variables'] = new DefinePlugin(environmentVariables);\n\n  if (isDev) {\n    // This is necessary to emit hot updates (currently CSS only):\n    pluginNames['Hot module replacement'] = new HotModuleReplacementPlugin();\n    // Watcher doesn't work well if you mistype casing in a path so we use\n    // a plugin that prints an error when you attempt to do this.\n    // See https://github.com/facebook/create-react-app/issues/240\n    pluginNames['Case sensitive paths'] = new CaseSensitivePathsPlugin();\n\n    // If you require a missing module and then `npm install` it, you still have\n    // to restart the development server for Webpack to discover it. This plugin\n    // makes the discovery automatic so you don't have to restart.\n    // See https://github.com/facebook/create-react-app/issues/186\n    pluginNames['Watching missing node modules'] = new WatchMissingNodeModulesPlugin(\n      locations.modules\n    );\n  }\n\n  if (isProd)\n    pluginNames['Performing CSS extraction'] = new MiniCssExtractPlugin({\n      // Options similar to the same options in webpackOptions.output\n      // both options are optional\n      filename: 'static/css/[name].[contenthash:8].css',\n      chunkFilename: 'static/css/[name].[contenthash:8].chunk.css',\n    });\n\n  // Generate a manifest file which contains a mapping of all asset filenames\n  // to their corresponding output file so that tools can pick it up without\n  // having to parse `index.html`.\n  pluginNames['Generating the asset manifest'] = new ManifestPlugin({\n    fileName: 'asset-manifest.json',\n    publicPath,\n  });\n\n  if (deepScopeAnalysisEnabled) {\n    const deepScope = new WebpackDeepScopeAnalysisPlugin();\n    // middlewarePlugins.push(deepScope);\n    pluginNames['Tree-Shaking'] = deepScope;\n  }\n\n  const serviceWorker = overrideWithPropertyOrConfig(\n    // Prevent service worker in development mode\n    config.web.build.serviceWorker,\n    DEFAULT_SERVICE_WORKER\n  );\n  if (serviceWorker) {\n    // Generate a service worker script that will precache, and keep up to date,\n    // the HTML & assets that are part of the Webpack build.\n    const serviceWorkerPlugin = new WorkboxPlugin.GenerateSW({\n      exclude: [\n        /\\.LICENSE$/,\n        /\\.map$/,\n        /asset-manifest\\.json$/,\n        // Exclude all apple touch images as they are cached locally after the PWA is added.\n        /^\\bapple.*\\.png$/,\n      ],\n      /// SINGLE PAGE:\n      // navigateFallback: `${publicPath}index.html`,\n      clientsClaim: true,\n      importWorkboxFrom: 'cdn',\n      navigateFallbackBlacklist: [\n        // Exclude URLs starting with /_, as they're likely an API call\n        new RegExp('^/_'),\n        // Exclude URLs containing a dot, as they're likely a resource in\n        // public/ and not a SPA route\n        new RegExp('/[^/]+\\\\.[^/]+$'),\n      ],\n      ...(isDev\n        ? {\n            include: [], // Don't cache any assets in dev mode.\n          }\n        : {}),\n      ...serviceWorker,\n    });\n    // middlewarePlugins.push(serviceWorkerPlugin);\n    pluginNames['Service-Worker'] = serviceWorkerPlugin;\n  }\n\n  if (gzipConfig) pluginNames['GZip Compression'] = new CompressionPlugin(gzipConfig);\n  if (brotliConfig) pluginNames['Brotli Compression'] = new BrotliPlugin(brotliConfig);\n  // pluginNames['Progress Bar'] = new ProgressBarPlugin({\n  //   format:\n  //     'Building Webpack bundle [:bar] ' + chalk.green.bold(':percent') + ' (:elapsed seconds) :msg',\n  //   clear: false,\n  //   complete: '=',\n  //   incomplete: ' ',\n  // });\n  pluginNames['Webpack Notification'] = new WebpackNotifierPlugin({\n    title: 'Expo Web',\n    contentImage: path.join(__dirname, '../web-default/icon.png'),\n  });\n\n  const reportConfig = enableWithPropertyOrConfig(\n    config.web.build.report,\n    DEFAULT_REPORT_CONFIG,\n    true\n  );\n\n  if (reportConfig) {\n    if (isDev && reportConfig.verbose) {\n      console.log('Generating a report, this will add noticeably more time to rebuilds.');\n    }\n    const reportDir = reportConfig.path;\n    const bundleAnalyzerPlugin = new BundleAnalyzerPlugin({\n      analyzerMode: 'static',\n      defaultSizes: 'gzip',\n      generateStatsFile: true,\n      openAnalyzer: false,\n      ...reportConfig,\n      logLevel: reportConfig.verbose ? 'info' : 'silent',\n      statsFilename: locations.absolute(reportDir, reportConfig.statsFilename),\n      reportFilename: locations.absolute(reportDir, reportConfig.reportFilename),\n    });\n    // Delete the report folder\n    pluginNames['Delete old report'] = new CleanWebpackPlugin([locations.absolute(reportDir)], {\n      root: locations.root,\n      dry: false,\n      verbose: reportConfig.verbose,\n    });\n    // Generate the report.html and stats.json\n    pluginNames['Analyze bundle'] = bundleAnalyzerPlugin;\n  }\n\n  const smp = new SpeedMeasurePlugin({ pluginNames });\n  // return smp.wrap(config);\n\n  return {\n    mode,\n    entry: {\n      app: appEntry,\n    },\n    // https://webpack.js.org/configuration/other-options/#bail\n    // Fail out on the first error instead of tolerating it.\n    bail: isProd,\n    devtool,\n    context: __dirname,\n    // configures where the build ends up\n    output: {\n      path: locations.production.folder,\n      sourceMapFilename: '[chunkhash].map',\n      // This is the URL that app is served from. We use \"/\" in development.\n      publicPath,\n    },\n    plugins: [\n      ...Object.values(pluginNames),\n      // ...reportPlugins,\n    ].filter(Boolean),\n    module: {\n      strictExportPresence: false,\n      rules: [\n        // Disable require.ensure because it breaks tree shaking.\n        { parser: { requireEnsure: false } },\n        {\n          oneOf: allLoaders,\n        },\n      ],\n    },\n\n    resolveLoader: {\n      plugins: [\n        // Also related to Plug'n'Play, but this time it tells Webpack to load its loaders\n        // from the current package.\n        PnpWebpackPlugin.moduleLoader(module),\n      ],\n    },\n    resolve: {\n      alias: DEFAULT_ALIAS,\n      extensions: [\n        '.web.ts',\n        '.web.tsx',\n        '.ts',\n        '.tsx',\n        '.web.js',\n        '.web.jsx',\n        '.js',\n        '.jsx',\n        '.json',\n      ],\n      plugins: [\n        // Adds support for installing with Plug'n'Play, leading to faster installs and adding\n        // guards against forgotten dependencies and such.\n        PnpWebpackPlugin,\n        // Prevents users from importing files from outside of node_modules/.\n        // This often causes confusion because we only process files within the root folder with babel.\n        // To fix this, we prevent you from importing files out of the root folder -- if you'd like to,\n        // please link the files into your node_modules/ and let module-resolution kick in.\n        // Make sure your source files are compiled, as they will not be processed in any way.\n        new ModuleScopePlugin(locations.template.folder, [locations.packageJson]),\n      ],\n      symlinks: false,\n    },\n\n    // Some libraries import Node modules but don't use them in the browser.\n    // Tell Webpack to provide empty mocks for them so importing them works.\n    node: {\n      module: 'empty',\n      dgram: 'empty',\n      dns: 'mock',\n      fs: 'empty',\n      http2: 'empty',\n      net: 'empty',\n      tls: 'empty',\n      child_process: 'empty',\n    },\n    // Turn off performance processing because we utilize\n    // our own (CRA) hints via the FileSizeReporter\n    performance: false,\n  };\n}\n"]}